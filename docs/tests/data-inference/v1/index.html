<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Data-Inference test</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="https://unpkg.com/vega@^5.25/build/vega.js" charset="utf-8"></script>
    <link rel="stylesheet" href="https://unpkg.com/@highlightjs/cdn-assets@11.7.0/styles/default.min.css">
    <script src="https://unpkg.com/@highlightjs/cdn-assets@11.7.0/highlight.min.js"></script>
    <script src="js/data-inference.js"></script>

    <style>
        body {
            font-family: sans-serif;
        }

        header {
            margin-bottom: 1em;
        }

        main {
            display: grid;
        }
    </style>
</head>

<body>
    <header>
        <h1>Data-Inference test</h1>
        <label>
            sample data file:
            <select onchange="test.loadText(this.value, {type: 'tsv'})">
                <option value="../../../sample-data/titanicmaster.tsv">titanic</option>
                <option value="../../../sample-data/demovote.tsv">demovote</option>
            </select>
        </label>
    </header>

    <main>

        <button onclick="navigator.clipboard.writeText(document.getElementsByTagName('code')[0].textContent)"
            style="float: right;">ðŸ“‹</button>

        Columns:
        <pre><code></code></pre>

    </main>

    <script>
        const test = {
            display: (content, highlight) => {
                document.getElementsByTagName('code')[0].innerHTML = content;
                if (highlight) {
                    hljs.highlightAll();
                }
            },
            loadObjectArray: (data) => {
                var columns = DataInference.getColumnsFromData(vega.inferTypes, data);
                test.display(JSON.stringify(columns, null, 2), true);
            },
            loadText: (url, format) => {
                test.display('Loading...');
                vega.loader().load(url).then(function (text) {
                    var data = vega.read(text, format);
                    test.loadObjectArray(data);
                });
            },
        };

        test.loadText('../../../sample-data/titanicmaster.tsv', { type: 'tsv' });

    </script>

</body>

</html>